<!-- âœ… NovaAI v26 (restored style) + FLUX 1.1 Pro debug wired
NOTE: This version only updates backend proxy + debug send. 
Do NOT use in production yet without switching PROXY back to proxy.php.
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NovaAI 26 Debug</title>
<style>
/* (Tu CSS original aquÃ­ â€“ no modificado) */
</style>
</head>
<body>
<!-- (Tu estructura original aquÃ­: chips A/B, Upload, Buttons, Result panel, history, etc.) -->

<script>
// âœ… TEMP backend debug server
// const PROXY = "/proxy.php"; // ðŸ‘‰ Lo volvemos luego
const PROXY = "https://novaai-flux-debug.onrender.com"; // âœ… tu Render debug

// ðŸ‘‰ Global vars
let selectedA = null;
let selectedB = null;
let lastOp = null;

// âœ… Capturar selecciÃ³n de chip A
function selectA(base64) {
  selectedA = base64;
  lastOp = "useA";
}

// âœ… Capturar subida B
const fileInput = document.getElementById("fileInput");
fileInput.onchange = function(e) {
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev){ selectedB = ev.target.result; lastOp = "useB"; };
  reader.readAsDataURL(file);
}

// âœ… Quick actions (igual que v26 original)
function qaReplace(){ lastOp = "qa-replace"; generate(); }
function qaOverlay(){ lastOp = "qa-overlay"; generate(); }
function qaUseA(){ lastOp = "qa-useA"; selectedB=null; generate(); }
function qaUseB(){ lastOp = "qa-useB"; selectedA=null; generate(); }

// âœ… GENERAR
async function generate(){
  const prompt = document.getElementById("promptField").value || "";
  const negative = "";

  const body = {
    ref: selectedA,
    image_base64: selectedB,
    prompt,
    negative,
    op: lastOp,
    params: { strength: 0.38 },
    debug: true // ðŸ”¥ modo diagnÃ³stico
  };

  const res = await fetch(`${PROXY}/api/generate`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify(body)
  });
  const data = await res.json();
  console.log("DEBUG RESPONSE",data);
  document.getElementById("result").textContent = JSON.stringify(data,null,2);
}
</script>

<pre id="result" style="color:#0f0;background:#111;padding:10px">Debug response...</pre>

</body>
</html>
